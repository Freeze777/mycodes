package algo.trie;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.Map;
import java.util.Scanner;
import java.util.TreeMap;

class Data {
	public long id;
	public double price;
	public String category;
	public String name;

	public Data(long id, double price, String category, String name) {
		this.price = price;
		this.id = id;
		this.category = category;
		this.name = name;
	}

	@Override
	public String toString() {
		return "Data [id=" + id + ", price=" + price + ", category=" + category
				+ ", name=" + name + "]";
	}

}

public class CatalogUsingTrie {
	private static class TrieNode {
		Map<Character, TrieNode> children;
		boolean isEnd;
		Data data;

		public TrieNode() {
			children = new TreeMap<Character, TrieNode>();
			isEnd = false;
		}
	}

	private static class Trie {
		private TrieNode root;

		public Trie() {
			root = new TrieNode();
		}

		public void insert(String word, Data data) {
			TrieNode crawl = root;
			for (int i = 0; i < word.length(); i++) {
				if (!crawl.children.containsKey(word.charAt(i)))
					crawl.children.put(word.charAt(i), new TrieNode());
				crawl = crawl.children.get(word.charAt(i));
			}
			crawl.isEnd = true;
			crawl.data = data;
			System.out.println("inserted");
		}

		public Data search(String word) {
			TrieNode crawl = root;
			for (int i = 0; i < word.length(); i++) {
				if (!crawl.children.containsKey(word.charAt(i)))
					return null;
				crawl = crawl.children.get(word.charAt(i));
			}
			return crawl.isEnd ? crawl.data : null;
		}
		public void dfs(){
			dfs(root);
		}
		private void dfs(TrieNode root) {
			if (root == null)
				return;
			if (root.children.size() == 0)
				return;
			if (root.isEnd)
				System.out.println(root.data);
			for (TrieNode node : root.children.values()) {
				dfs(node);
			}
		}

		public boolean startsWith(String prefix) {
			TrieNode crawl = root;
			for (int i = 0; i < prefix.length(); i++) {
				if (!crawl.children.containsKey(prefix.charAt(i)))
					return false;
				crawl = crawl.children.get(prefix.charAt(i));
			}
			dfs(crawl);
			return true;
		}
	}

	public static void main(String[] args) {
		Trie trie = new Trie();
		try {
			Scanner sc = new Scanner(new File("product.csv"));
			while (sc.hasNextLine()) {
				System.out.println("here");
				String[] input = sc.nextLine().split(",");
				Data data = new Data(Long.parseLong(input[0]),
						Double.parseDouble(input[2]), input[3], input[1]);
				trie.insert(input[1], data);

			}
			trie.dfs();
			
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	
}
