package algo.trees;

import java.util.Stack;

public class SerializationValidation {

    public boolean isValidSerialization(String str) {
        if(str.length()==0)
            return false;
        String[] preorder=str.split(",");
        if(preorder.length==1)
            return preorder[0].charAt(0)=='#';
        if(preorder[0].charAt(0)=='#')
            return false;
        Stack<Integer> s=new Stack<Integer>();
        int[] count=new int[preorder.length];
        s.push(0);
        int i=1;
        while(!s.isEmpty()&&i<count.length){
            count[s.peek()]++;
            if(count[s.peek()]==2){
                s.pop();
            }
            if(preorder[i].charAt(0)!='#'){
                s.push(i);
            }
            i++;
        }
        return (i==count.length)?(s.size()==0):false;
    }

}
