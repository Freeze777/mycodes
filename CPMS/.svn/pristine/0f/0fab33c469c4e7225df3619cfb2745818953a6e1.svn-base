package centurylink.cpms;

import java.sql.SQLException;
import java.util.ArrayList;

import org.hibernate.HibernateException;

public class DAOLayer implements DAOInterface {


	public void storeUserDetailsInDB(User user) throws CpmsConstraintViolation, CpmsException {
		// TODO Auto-generated method stub
		System.out.println("storeUserDetails-in DAO");
		//DBOps db=new DBOps(MakeCon.r);
		HibernateOps hb=new HibernateOps();
		hb.addCpmsUser(user,HibernateConnection.getFactory());

		//db.insert(user);

	}


	public DAOLayer() {
		try {
			makeDBconnection();
		} catch (IllegalArgumentException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}


	public String retrieveDetailsInDB(User user) throws HibernateException, CpmsException {
		// TODO Auto-generated method stub
		//DBOps db=new DBOps(MakeCon.r);
		System.out.println("retrieveUserDetails-in DAO");
		HibernateOps hb=new HibernateOps();
		return hb.selectCpmsUser(user, HibernateConnection.getFactory());
		//return(db.select(user));

	}


	@Override
	public void makeDBconnection() throws SQLException,
	IllegalArgumentException {
		// TODO Auto-generated method stub
		HibernateConnection.createConnection();


	}



	@Override
	public void storeRoutesDetailsInDB(Routes routes,long cid) throws  HibernateException, CpmsException {

		// TODO Auto-generated method stub
		System.out.println("storeRouteDetails-in DAO");
		//DBOps db=new DBOps(MakeCon.r);
		HibernateOps hb=new HibernateOps();
		hb.addCpmsRoutes(routes,HibernateConnection.getFactory(),cid);



		// TODO Auto-generated method stub

	}




	@Override
	public void storeTransitsDetailsInDB(long toRouteId, long fromRouteId, Long cid,
			String[] toTrasitsArray, int toLength, String[] fromTrasitsArray,
			int fromLength)throws  HibernateException, NullPointerException, CpmsConstraintViolation, CpmsException {
		// TODO Auto-generated method stub
		System.out.println("storeTransitDetails-in DAO");
		HibernateOps hb=new HibernateOps();
		hb.addCpmsTransits(toRouteId,fromRouteId,cid,toTrasitsArray,toLength,fromTrasitsArray,fromLength,
				HibernateConnection.getFactory());
		
	}


	@Override
	public ArrayList<String> getTransitListFromDB() throws  CpmsException {
		// TODO Auto-generated method stub
		System.out.println("getTransitListFromDB-in DAO");
		HibernateOps hb=new HibernateOps();
		ArrayList<String> list =null;
		list = hb.fillCpmsTransitList(HibernateConnection.getFactory());
		
		return list;
	}


	@Override
	public ArrayList<SearchArray> getUserSearchResultsFromDB(String to,
			String from, int time) throws HibernateException, NoRoutesFoundException, CpmsException {
		// TODO Auto-generated method stub
		System.out.println("getTransitListFromDB-in DAO");
		HibernateOps hb=new HibernateOps();
		ArrayList<SearchArray> list =null;
		
		
			list = hb.searchCpmsRoutes(to, from, time, HibernateConnection.getFactory());
		
			return list;
	}



	@Override
	public String makeUserRequestinDB(String rcuid, String ocuid, String from,
			String to,int time,Long routeid) throws CpmsException {
		// TODO Auto-generated method stub
		System.out.println("makeRequestinDB-in DAO");
		
		HibernateOps hb=new HibernateOps();
		hb.addRequestToLog(rcuid,ocuid,from,to,time,routeid,HibernateConnection.getFactory());
		return "ok";
	}
	
	
	@Override
	public void storeTransitsDetailsInDB(Routes routes, Long cid)
			throws  HibernateException, NullPointerException, CpmsException {
		System.out.println("storeSeatDetails-in DAO");
		HibernateOps hb=new HibernateOps();
		hb.addCpmsSeats(routes,HibernateConnection.getFactory(),cid);
		
	}

	@Override
	public ArrayList<CpmsRequestLogs> getDashboardinDB(Long cid) throws CpmsException {
		// TODO Auto-generated method stub
		
System.out.println("getDashboardinDB-in DAO");
		
		HibernateOps hb=new HibernateOps();
		return hb.getDashBoardfromDB(cid,HibernateConnection.getFactory());
	}




	@Override
	public void acceptRequestIntoDB(String rcuid, String ocuid, Long routeid)
			throws  CpmsException {
		// TODO Auto-generated method stub
		HibernateOps hb=new HibernateOps();
		hb.grantCmpsRequest(rcuid,ocuid,routeid,HibernateConnection.getFactory());
		
	}


	@Override
	public void declineRequestIntoDB(String rcuid, String ocuid, Long routeid)
			throws  CpmsException {
		// TODO Auto-generated method stub
		HibernateOps hb=new HibernateOps();
		hb.declineCpmsRequest(rcuid,ocuid,routeid,HibernateConnection.getFactory());
		
	}



}
